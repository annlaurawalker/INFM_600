---
title: "IPEDS Data"
author: "Himanshi Manglunia, Kalpita Raut, Laura Walker"
date: "November 9, 2018"
output: html_document
---

```{r setup, include=FALSE}
# Load RODBC package 
# Connects R Code to the database/warehouse
# install.packages("RODBC") # only needs to be run once
library(RODBC)
```
 ## Data from year 2015-16
```{r setup, include=FALSE}
# for 64 bit windows
# Getting Access databases connected to R involved some research. 
# Follow instructions for access databases here: https://www.r-bloggers.com/getting-access-data-into-r/ 
channel <- odbcDriverConnect("Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=H:/IPEDS/2015_16_IPEDS_Database.accdb")
 year_2015 <- sqlQuery(channel, "SELECT HD2015.UNITID, HD2015.INSTNM, HD2015.LONGITUD, HD2015.LATITUDE, ADM2015.ACTCM25, ADM2015.ACTCM75, ADM2015.ACTEN25, ADM2015.ACTEN75, ADM2015.ACTMT25, ADM2015.ACTMT75, ADM2015.ACTNUM, ADM2015.SATPCT, ADM2015.ACTWR25, ADM2015.ACTWR75, ADM2015.ADMCON7, ADM2015.ADMCON8, ADM2015.ADMCON9, ADM2015.SATMT25, ADM2015.SATMT75, ADM2015.SATNUM, ADM2015.SATVR25, ADM2015.SATVR75, ADM2015.SATWR25, ADM2015.SATWR75, SFA1415_P1.SCFA2, SFA1415_P1.SCFY2, SFA1415_P1.SCUGRAD, SFA1415_P2.GIS4G0, SFA1415_P2.GIS4G1, SFA1415_P2.GIS4G10, SFA1415_P2.GIS4G11, SFA1415_P2.GIS4G12, SFA1415_P2.GIS4G2, SFA1415_P2.GIS4G20, SFA1415_P2.GIS4G21, SFA1415_P2.GIS4G22, SFA1415_P2.GIS4G30, SFA1415_P2.GIS4G31, SFA1415_P2.GIS4G32, SFA1415_P2.GIS4G40, SFA1415_P2.GIS4G41, SFA1415_P2.GIS4G42, SFA1415_P2.GIS4G50, SFA1415_P2.GIS4G51, SFA1415_P2.GIS4G52, SFA1415_P2.GRN4G0, SFA1415_P2.GRN4G1, SFA1415_P2.GRN4G10, SFA1415_P2.GRN4G11, SFA1415_P2.GRN4G12, SFA1415_P2.GRN4G2, SFA1415_P2.GRN4G20, SFA1415_P2.GRN4G21, SFA1415_P2.GRN4G22, SFA1415_P2.GRN4G30, SFA1415_P2.GRN4G31, SFA1415_P2.GRN4G32, SFA1415_P2.GRN4G40, SFA1415_P2.GRN4G41, SFA1415_P2.GRN4G42, SFA1415_P2.GRN4G50, SFA1415_P2.GRN4G51, SFA1415_P2.GRN4G52 FROM SFA1415_P2 INNER JOIN (SFA1415_P1 INNER JOIN (ADM2015 INNER JOIN HD2015 ON ADM2015.UNITID = HD2015.UNITID) ON SFA1415_P1.UNITID = HD2015.UNITID) ON SFA1415_P2.UNITID = HD2015.UNITID WHERE (((HD2015.UNITID) In (151351,171100,147767,204796,214777,243780,186380,145637,153658,163286,170976,174066,181464,240444)));", as.is=TRUE) 
 # creating a year field
year_2015$year <- 2015
```
 ## Data from year 2014-15
```{r setup, include=FALSE}
channel <- odbcDriverConnect("Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=H:/IPEDS/2014_15_IPEDS_Database.accdb")
 year_2014 <- sqlQuery(channel, "SELECT HD2014.UNITID, HD2014.INSTNM, HD2014.LONGITUD, HD2014.LATITUDE, ADM2014.ACTCM25, ADM2014.ACTCM75, ADM2014.ACTEN25, ADM2014.ACTEN75, ADM2014.ACTMT25, ADM2014.ACTMT75, ADM2014.ACTNUM, ADM2014.SATPCT AS SATPCT, ADM2014.ACTWR25, ADM2014.ACTWR75, ADM2014.ADMCON7, ADM2014.ADMCON8, ADM2014.ADMCON9, ADM2014.SATMT25, ADM2014.SATMT75, ADM2014.SATNUM, ADM2014.SATVR25, ADM2014.SATVR75, ADM2014.SATWR25, ADM2014.SATWR75, SFA1314_P1.SCFA2, SFA1314_P1.SCFY2, SFA1314_P1.SCUGRAD, SFA1314_P2.GIS4G0, SFA1314_P2.GIS4G1, SFA1314_P2.GIS4G10, SFA1314_P2.GIS4G11, SFA1314_P2.GIS4G12, SFA1314_P2.GIS4G2, SFA1314_P2.GIS4G20, SFA1314_P2.GIS4G21, SFA1314_P2.GIS4G22, SFA1314_P2.GIS4G30, SFA1314_P2.GIS4G31, SFA1314_P2.GIS4G32, SFA1314_P2.GIS4G40, SFA1314_P2.GIS4G41, SFA1314_P2.GIS4G42, SFA1314_P2.GIS4G50, SFA1314_P2.GIS4G51, SFA1314_P2.GIS4G52, SFA1314_P2.GRN4G0, SFA1314_P2.GRN4G1, SFA1314_P2.GRN4G10, SFA1314_P2.GRN4G11, SFA1314_P2.GRN4G12, SFA1314_P2.GRN4G2, SFA1314_P2.GRN4G20, SFA1314_P2.GRN4G21, SFA1314_P2.GRN4G22, SFA1314_P2.GRN4G30, SFA1314_P2.GRN4G31, SFA1314_P2.GRN4G32, SFA1314_P2.GRN4G40, SFA1314_P2.GRN4G41, SFA1314_P2.GRN4G42, SFA1314_P2.GRN4G50, SFA1314_P2.GRN4G51, SFA1314_P2.GRN4G52 FROM SFA1314_P2 INNER JOIN (SFA1314_P1 INNER JOIN (ADM2014 INNER JOIN HD2014 ON ADM2014.UNITID = HD2014.UNITID) ON SFA1314_P1.UNITID = HD2014.UNITID) ON SFA1314_P2.UNITID = HD2014.UNITID WHERE (((HD2014.UNITID) In (151351,171100,147767,204796,214777,243780,186380,145637,153658,163286,170976,174066,181464,240444)));", as.is=TRUE) 
 # creating a year field
year_2014$year <- 2014
```
 ## Data from year 2013-14
```{r setup, include=FALSE}
channel <- odbcDriverConnect("Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=H:/IPEDS/2013_14_IPEDS_Database.accdb")
 year_2013 <- sqlQuery(channel, "SELECT HD2013.UNITID, HD2013.INSTNM, HD2013.LONGITUD, HD2013.LATITUDE, IC2013.ACTCM25, IC2013.ACTCM75, IC2013.ACTEN25, IC2013.ACTEN75, IC2013.ACTMT25, IC2013.ACTMT75, IC2013.ACTNUM, IC2013.SATPCT, IC2013.ACTWR25, IC2013.ACTWR75, IC2013.ADMCON7, IC2013.ADMCON8, IC2013.ADMCON9, IC2013.SATMT25, IC2013.SATMT75, IC2013.SATNUM, IC2013.SATVR25, IC2013.SATVR75, IC2013.SATWR25, IC2013.SATWR75, SFA1213_P1.SCFA2, SFA1213_P1.SCFY2, SFA1213_P1.SCUGRAD, SFA1213_P2.GIS4G0, SFA1213_P2.GIS4G1, SFA1213_P2.GIS4G10, SFA1213_P2.GIS4G11, SFA1213_P2.GIS4G12, SFA1213_P2.GIS4G2, SFA1213_P2.GIS4G20, SFA1213_P2.GIS4G21, SFA1213_P2.GIS4G22, SFA1213_P2.GIS4G30, SFA1213_P2.GIS4G31, SFA1213_P2.GIS4G32, SFA1213_P2.GIS4G40, SFA1213_P2.GIS4G41, SFA1213_P2.GIS4G42, SFA1213_P2.GIS4G50, SFA1213_P2.GIS4G51, SFA1213_P2.GIS4G52, SFA1213_P2.GRN4G0, SFA1213_P2.GRN4G1, SFA1213_P2.GRN4G10, SFA1213_P2.GRN4G11, SFA1213_P2.GRN4G12, SFA1213_P2.GRN4G2, SFA1213_P2.GRN4G20, SFA1213_P2.GRN4G21, SFA1213_P2.GRN4G22, SFA1213_P2.GRN4G30, SFA1213_P2.GRN4G31, SFA1213_P2.GRN4G32, SFA1213_P2.GRN4G40, SFA1213_P2.GRN4G41, SFA1213_P2.GRN4G42, SFA1213_P2.GRN4G50, SFA1213_P2.GRN4G51, SFA1213_P2.GRN4G52
FROM SFA1213_P2 INNER JOIN (SFA1213_P1 INNER JOIN (IC2013 INNER JOIN HD2013 ON IC2013.UNITID = HD2013.UNITID) ON SFA1213_P1.UNITID = HD2013.UNITID) ON SFA1213_P2.UNITID = HD2013.UNITID
WHERE (((HD2013.UNITID) In (151351,171100,147767,204796,214777,243780,186380,145637,153658,163286,170976,174066,181464,240444)));
", as.is=TRUE) 
 # creating a year field
year_2013$year <- 2013
```
 ## Data from year 2012-13
```{r setup, include=FALSE}
channel <- odbcDriverConnect("Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=H:/IPEDS/2012_13_IPEDS_Database.accdb")
 year_2012 <- sqlQuery(channel, "SELECT HD2012.UNITID, HD2012.INSTNM, HD2012.LONGITUD, HD2012.LATITUDE, IC2012.ACTCM25, IC2012.ACTCM75, IC2012.ACTEN25, IC2012.ACTEN75, IC2012.ACTMT25, IC2012.ACTMT75, IC2012.ACTNUM, IC2012.SATPCT, IC2012.ACTWR25, IC2012.ACTWR75, IC2012.ADMCON7, IC2012.ADMCON8, IC2012.ADMCON9, IC2012.SATMT25, IC2012.SATMT75, IC2012.SATNUM, IC2012.SATVR25, IC2012.SATVR75, IC2012.SATWR25, IC2012.SATWR75, SFA1112_P1.SCFA2, SFA1112_P1.SCFY2, SFA1112_P1.SCUGRAD, SFA1112_P2.GIS4G0, SFA1112_P2.GIS4G1, SFA1112_P2.GIS4G10, SFA1112_P2.GIS4G11, SFA1112_P2.GIS4G12, SFA1112_P2.GIS4G2, SFA1112_P2.GIS4G20, SFA1112_P2.GIS4G21, SFA1112_P2.GIS4G22, SFA1112_P2.GIS4G30, SFA1112_P2.GIS4G31, SFA1112_P2.GIS4G32, SFA1112_P2.GIS4G40, SFA1112_P2.GIS4G41, SFA1112_P2.GIS4G42, SFA1112_P2.GIS4G50, SFA1112_P2.GIS4G51, SFA1112_P2.GIS4G52, SFA1112_P2.GRN4G0, SFA1112_P2.GRN4G1, SFA1112_P2.GRN4G10, SFA1112_P2.GRN4G11, SFA1112_P2.GRN4G12, SFA1112_P2.GRN4G2, SFA1112_P2.GRN4G20, SFA1112_P2.GRN4G21, SFA1112_P2.GRN4G22, SFA1112_P2.GRN4G30, SFA1112_P2.GRN4G31, SFA1112_P2.GRN4G32, SFA1112_P2.GRN4G40, SFA1112_P2.GRN4G41, SFA1112_P2.GRN4G42, SFA1112_P2.GRN4G50, SFA1112_P2.GRN4G51, SFA1112_P2.GRN4G52 FROM SFA1112_P2 INNER JOIN (SFA1112_P1 INNER JOIN (IC2012 INNER JOIN HD2012 ON IC2012.UNITID = HD2012.UNITID) ON SFA1112_P1.UNITID = HD2012.UNITID) ON SFA1112_P2.UNITID = HD2012.UNITID WHERE (((HD2012.UNITID) In (151351,171100,147767,204796,214777,243780,186380,145637,153658,163286,170976,174066,181464,240444)));", as.is=TRUE) 
 # creating a year field
year_2012$year <- 2012
```
 ## Data from year 2011-12
```{r setup, include=FALSE}
channel <- odbcDriverConnect("Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=H:/IPEDS/2011_12_IPEDS_Database.accdb")
 year_2011 <- sqlQuery(channel, "SELECT HD2011.UNITID, HD2011.INSTNM, HD2011.LONGITUD, HD2011.LATITUDE, IC2011.ACTCM25, IC2011.ACTCM75, IC2011.ACTEN25, IC2011.ACTEN75, IC2011.ACTMT25, IC2011.ACTMT75, IC2011.ACTNUM, IC2011.SATPCT, IC2011.ACTWR25, IC2011.ACTWR75, IC2011.ADMCON7, IC2011.ADMCON8, IC2011.ADMCON9, IC2011.SATMT25, IC2011.SATMT75, IC2011.SATNUM, IC2011.SATVR25, IC2011.SATVR75, IC2011.SATWR25, IC2011.SATWR75, SFA1011_P1.SCFA2, SFA1011_P1.SCFY2, SFA1011_P1.SCUGRAD, SFA1011_P2.GIS4G0, SFA1011_P2.GIS4G1, SFA1011_P2.GIS4G10, SFA1011_P2.GIS4G11, SFA1011_P2.GIS4G12, SFA1011_P2.GIS4G2, SFA1011_P2.GIS4G20, SFA1011_P2.GIS4G21, SFA1011_P2.GIS4G22, SFA1011_P2.GIS4G30, SFA1011_P2.GIS4G31, SFA1011_P2.GIS4G32, SFA1011_P2.GIS4G40, SFA1011_P2.GIS4G41, SFA1011_P2.GIS4G42, SFA1011_P2.GIS4G50, SFA1011_P2.GIS4G51, SFA1011_P2.GIS4G52, SFA1011_P2.GRN4G0, SFA1011_P2.GRN4G1, SFA1011_P2.GRN4G10, SFA1011_P2.GRN4G11, SFA1011_P2.GRN4G12, SFA1011_P2.GRN4G2, SFA1011_P2.GRN4G20, SFA1011_P2.GRN4G21, SFA1011_P2.GRN4G22, SFA1011_P2.GRN4G30, SFA1011_P2.GRN4G31, SFA1011_P2.GRN4G32, SFA1011_P2.GRN4G40, SFA1011_P2.GRN4G41, SFA1011_P2.GRN4G42, SFA1011_P2.GRN4G50, SFA1011_P2.GRN4G51, SFA1011_P2.GRN4G52 FROM SFA1011_P2 INNER JOIN (SFA1011_P1 INNER JOIN (IC2011 INNER JOIN HD2011 ON IC2011.UNITID = HD2011.UNITID) ON SFA1011_P1.UNITID = HD2011.UNITID) ON SFA1011_P2.UNITID = HD2011.UNITID WHERE (((HD2011.UNITID) In (151351,171100,147767,204796,214777,243780,186380,145637,153658,163286,170976,174066,181464,240444)));", as.is=TRUE) 
 # creating a year field
year_2011$year <- 2011
```

```{r setup, include=FALSE}
# Combining all five years into one dataframe
 IPEDS <- rbind(year_2011, year_2012, year_2013, year_2014, year_2015)
 # Removes the individual years
rm(year_2011, year_2012, year_2013, year_2014, year_2015)
 # Writes a text file to working directory 
 write.table(IPEDS,"IPEDS.txt",sep="\t",row.names=FALSE)
```
